#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_3__   TYPE_1__ ;

/* Type definitions */
struct TYPE_3__ {scalar_t__ state; int key; } ;
typedef  TYPE_1__ PS2KbdRawKey ;

/* Variables and functions */
 int AKEY_0 ; 
 int AKEY_1 ; 
 int AKEY_2 ; 
 int AKEY_3 ; 
 int AKEY_4 ; 
 int AKEY_5 ; 
 int AKEY_5200_START ; 
 int AKEY_6 ; 
 int AKEY_7 ; 
 int AKEY_8 ; 
 int AKEY_9 ; 
 int AKEY_A ; 
 int AKEY_AMPERSAND ; 
 int AKEY_ASTERISK ; 
 int AKEY_AT ; 
 int AKEY_ATARI ; 
 int AKEY_B ; 
 int AKEY_BACKSLASH ; 
 int AKEY_BACKSPACE ; 
 int AKEY_BAR ; 
 int AKEY_BRACKETLEFT ; 
 int AKEY_BRACKETRIGHT ; 
 int AKEY_C ; 
 int AKEY_CAPSTOGGLE ; 
 int AKEY_CARET ; 
 int AKEY_CLRTAB ; 
 int AKEY_COLDSTART ; 
 int AKEY_COLON ; 
 int AKEY_COMMA ; 
 int AKEY_CTRL ; 
 int AKEY_CTRL_0 ; 
 int AKEY_CTRL_1 ; 
 int AKEY_CTRL_2 ; 
 int AKEY_CTRL_3 ; 
 int AKEY_CTRL_4 ; 
 int AKEY_CTRL_5 ; 
 int AKEY_CTRL_6 ; 
 int AKEY_CTRL_7 ; 
 int AKEY_CTRL_8 ; 
 int AKEY_CTRL_9 ; 
 int AKEY_CTRL_a ; 
 int AKEY_CTRL_b ; 
 int AKEY_CTRL_c ; 
 int AKEY_CTRL_d ; 
 int AKEY_CTRL_e ; 
 int AKEY_CTRL_f ; 
 int AKEY_CTRL_g ; 
 int AKEY_CTRL_h ; 
 int AKEY_CTRL_i ; 
 int AKEY_CTRL_j ; 
 int AKEY_CTRL_k ; 
 int AKEY_CTRL_l ; 
 int AKEY_CTRL_m ; 
 int AKEY_CTRL_n ; 
 int AKEY_CTRL_o ; 
 int AKEY_CTRL_p ; 
 int AKEY_CTRL_q ; 
 int AKEY_CTRL_r ; 
 int AKEY_CTRL_s ; 
 int AKEY_CTRL_t ; 
 int AKEY_CTRL_u ; 
 int AKEY_CTRL_v ; 
 int AKEY_CTRL_w ; 
 int AKEY_CTRL_x ; 
 int AKEY_CTRL_y ; 
 int AKEY_CTRL_z ; 
 int AKEY_D ; 
 int AKEY_DBLQUOTE ; 
 int AKEY_DELETE_CHAR ; 
 int AKEY_DELETE_LINE ; 
 int AKEY_DOLLAR ; 
 int AKEY_DOWN ; 
 int AKEY_E ; 
 int AKEY_EQUAL ; 
 int AKEY_ESCAPE ; 
 int AKEY_EXCLAMATION ; 
 int AKEY_EXIT ; 
 int AKEY_F ; 
 int AKEY_FULLSTOP ; 
 int AKEY_G ; 
 int AKEY_GREATER ; 
 int AKEY_H ; 
 int AKEY_HASH ; 
 int AKEY_HELP ; 
 int AKEY_I ; 
 int AKEY_INSERT_CHAR ; 
 int AKEY_INSERT_LINE ; 
 int AKEY_J ; 
 int AKEY_K ; 
 int AKEY_L ; 
 int AKEY_LEFT ; 
 int AKEY_LESS ; 
 int AKEY_M ; 
 int AKEY_MINUS ; 
 int AKEY_N ; 
 int AKEY_NONE ; 
 int AKEY_O ; 
 int AKEY_P ; 
 int AKEY_PARENLEFT ; 
 int AKEY_PARENRIGHT ; 
 int AKEY_PERCENT ; 
 int AKEY_PLUS ; 
 int AKEY_Q ; 
 int AKEY_QUESTION ; 
 int AKEY_QUOTE ; 
 int AKEY_R ; 
 int AKEY_RETURN ; 
 int AKEY_RIGHT ; 
 int AKEY_S ; 
 int AKEY_SCREENSHOT ; 
 int AKEY_SCREENSHOT_INTERLACE ; 
 int AKEY_SEMICOLON ; 
 int AKEY_SETTAB ; 
 int AKEY_SLASH ; 
 int AKEY_SPACE ; 
 int AKEY_T ; 
 int AKEY_TAB ; 
 int AKEY_U ; 
 int AKEY_UI ; 
 int AKEY_UNDERSCORE ; 
 int AKEY_UP ; 
 int AKEY_V ; 
 int AKEY_W ; 
 int AKEY_WARMSTART ; 
 int AKEY_X ; 
 int AKEY_Y ; 
 int AKEY_Z ; 
 int AKEY_a ; 
 int AKEY_b ; 
 int AKEY_c ; 
 int AKEY_d ; 
 int AKEY_e ; 
 int AKEY_f ; 
 int AKEY_g ; 
 int AKEY_h ; 
 int AKEY_i ; 
 int AKEY_j ; 
 int AKEY_k ; 
 int AKEY_l ; 
 int AKEY_m ; 
 int AKEY_n ; 
 int AKEY_o ; 
 int AKEY_p ; 
 int AKEY_q ; 
 int AKEY_r ; 
 int AKEY_s ; 
 int AKEY_t ; 
 int AKEY_u ; 
 int AKEY_v ; 
 int AKEY_w ; 
 int AKEY_x ; 
 int AKEY_y ; 
 int AKEY_z ; 
 int /*<<< orphan*/  Atari800_Exit (int /*<<< orphan*/ ) ; 
 scalar_t__ Atari800_MACHINE_5200 ; 
 scalar_t__ Atari800_machine_type ; 
#define  EOF 128 
 int /*<<< orphan*/  FALSE ; 
 int /*<<< orphan*/  INPUT_CONSOL_NONE ; 
 int /*<<< orphan*/  INPUT_CONSOL_SELECT ; 
 int /*<<< orphan*/  INPUT_CONSOL_START ; 
 int /*<<< orphan*/  INPUT_key_consol ; 
 int PAD_CIRCLE ; 
 int PAD_CROSS ; 
 int PAD_DOWN ; 
 int PAD_L1 ; 
 int PAD_LEFT ; 
 int PAD_R1 ; 
 int PAD_RIGHT ; 
 int PAD_SELECT ; 
 int PAD_SQUARE ; 
 int PAD_START ; 
 int PAD_TRIANGLE ; 
 int PAD_UP ; 
 scalar_t__ PS2KBD_RAWKEY_DOWN ; 
 scalar_t__ PS2KBD_RAWKEY_UP ; 
 int PS2KbdALT ; 
 int PS2KbdCONTROL ; 
 scalar_t__ PS2KbdReadRaw (TYPE_1__*) ; 
 int PS2KbdSHIFT ; 
 int PadButtons () ; 
 int /*<<< orphan*/  UI_MENU_ABOUT ; 
 int /*<<< orphan*/  UI_MENU_CARTRIDGE ; 
 int /*<<< orphan*/  UI_MENU_CASSETTE ; 
 int /*<<< orphan*/  UI_MENU_DISK ; 
 int /*<<< orphan*/  UI_MENU_LOADSTATE ; 
 int /*<<< orphan*/  UI_MENU_RUN ; 
 int /*<<< orphan*/  UI_MENU_SAVESTATE ; 
 int /*<<< orphan*/  UI_MENU_SYSTEM ; 
 int /*<<< orphan*/  UI_alt_function ; 
 scalar_t__ UI_is_active ; 
 int /*<<< orphan*/  exit (int /*<<< orphan*/ ) ; 

int PLATFORM_Keyboard(void)
{
	int new_pad = PadButtons();
	PS2KbdRawKey key;
	INPUT_key_consol = INPUT_CONSOL_NONE;

	if (UI_is_active) {
		if (new_pad & PAD_CROSS)
			return AKEY_RETURN;
		if (new_pad & PAD_CIRCLE)
			return AKEY_ESCAPE;
		if (new_pad & PAD_LEFT)
			return AKEY_LEFT;
		if (new_pad & PAD_RIGHT)
			return AKEY_RIGHT;
		if (new_pad & PAD_UP)
			return AKEY_UP;
		if (new_pad & PAD_DOWN)
			return AKEY_DOWN;
		if (new_pad & PAD_L1)
		    return AKEY_COLDSTART;
		if (new_pad & PAD_R1)
			return AKEY_WARMSTART;
	}
	//PAD_CROSS is used for PLATFORM_TRIG().
	if (new_pad & PAD_TRIANGLE)
		return AKEY_UI;
	if (new_pad & PAD_SQUARE)
		return AKEY_SPACE;
	if (new_pad & PAD_CIRCLE)
		return AKEY_RETURN;
	if (new_pad & PAD_L1)
		return AKEY_COLDSTART;
	if (new_pad & PAD_R1)
		return AKEY_WARMSTART;
	if (Atari800_machine_type == Atari800_MACHINE_5200) {
		if (new_pad & PAD_START)
			return AKEY_5200_START;
	}
	else {
		if (new_pad & PAD_START)
			INPUT_key_consol ^= INPUT_CONSOL_START;
		if (new_pad & PAD_SELECT)
			INPUT_key_consol ^= INPUT_CONSOL_SELECT;
		if (new_pad & PAD_CROSS)
			return AKEY_HELP;
	}
if (Atari800_machine_type != Atari800_MACHINE_5200 || UI_is_active) {

	while (PS2KbdReadRaw(&key) != 0) {
		if (key.state == PS2KBD_RAWKEY_DOWN) {
			switch (key.key) {
			case EOF:
				Atari800_Exit(FALSE);
				exit(0);
			    break;
			case 0x28:
				return AKEY_RETURN;
			case 0x29:
				return AKEY_ESCAPE;
			case 0x2A:
				return AKEY_BACKSPACE;
			case 0x2B:
				return AKEY_TAB;
			case 0x2C:
				return AKEY_SPACE;
			case 0x46://Print Screen Button
				return AKEY_SCREENSHOT;
			case 0x4F:
			    return AKEY_RIGHT;
			case 0x50:
			    return AKEY_LEFT;
			case 0x51:
			    return AKEY_DOWN;
			case 0x52:
			    return AKEY_UP;
			case 0x58:
			    return AKEY_RETURN;

			case 0xE0:
				PS2KbdCONTROL = 1;
				return AKEY_NONE;
			case 0xE4:
				PS2KbdCONTROL = 1;
				return AKEY_NONE;
			case 0xE1:
				PS2KbdSHIFT = 1;
				return AKEY_NONE;
			case 0xE2:
				PS2KbdALT = 1;
				return AKEY_NONE;
			case 0xE5:
				PS2KbdSHIFT = 1;
				return AKEY_NONE;
			case 0xE6:
				PS2KbdALT = 1;
				return AKEY_NONE;
			default:
				break;
			}
		}

		if ((key.state == PS2KBD_RAWKEY_DOWN) && !PS2KbdSHIFT && !PS2KbdALT) {
			switch (key.key) {
			case 0x1E:
				return AKEY_1;
			case 0X1F:
				return AKEY_2;
			case 0x20:
				return AKEY_3;
			case 0x21:
				return AKEY_4;
			case 0x22:
				return AKEY_5;
			case 0x23:
				return AKEY_6;
			case 0x24:
				return AKEY_7;
			case 0x25:
				return AKEY_8;
			case 0x26:
				return AKEY_9;
			case 0x27:
				return AKEY_0;
			case 0x2D:
				return AKEY_MINUS;
			case 0x2E:
				return AKEY_EQUAL;
			case 0x2F:
				return AKEY_BRACKETLEFT;
			case 0x30:
				return AKEY_BRACKETRIGHT;
			case 0x31:
				return AKEY_BACKSLASH;
			case 0x33:
				return AKEY_SEMICOLON;
			case 0x34:
				return AKEY_QUOTE;
			case 0x35:
				return AKEY_ATARI;
			case 0x36:
				return AKEY_COMMA;
			case 0x37:
				return AKEY_FULLSTOP;
			case 0x38:
				return AKEY_SLASH;
			case 0x3A://F1
				return AKEY_UI;
			case 0x3E://F5
				return AKEY_WARMSTART;
			case 0x42://F9
				return AKEY_EXIT;
			case 0x43://F10
				return AKEY_SCREENSHOT;
			default:
				break;
			}
		}
		if ((key.state == PS2KBD_RAWKEY_DOWN) && PS2KbdSHIFT && !PS2KbdCONTROL && !PS2KbdALT) {
			switch (key.key) {
			case 0x4:
				return AKEY_A;
			case 0x5:
				return AKEY_B;
			case 0x6:
				return AKEY_C;
			case 0x7:
				return AKEY_D;
			case 0x8:
				return AKEY_E;
			case 0x9:
				return AKEY_F;
			case 0xA:
				return AKEY_G;
			case 0xB:
				return AKEY_H;
			case 0xC:
				return AKEY_I;
			case 0xD:
				return AKEY_J;
			case 0xE:
				return AKEY_K;
			case 0xF:
				return AKEY_L;
			case 0x10:
				return AKEY_M;
			case 0x11:
				return AKEY_N;
			case 0x12:
				return AKEY_O;
			case 0x13:
				return AKEY_P;
			case 0x14:
				return AKEY_Q;
			case 0x15:
				return AKEY_R;
			case 0x16:
				return AKEY_S;
			case 0x17:
				return AKEY_T;
			case 0x18:
				return AKEY_U;
			case 0x19:
				return AKEY_V;
			case 0x1A:
				return AKEY_W;
			case 0x1B:
				return AKEY_X;
			case 0x1C:
				return AKEY_Y;
			case 0x1D:
				return AKEY_Z;
			case 0x1E:
				return AKEY_EXCLAMATION;
			case 0X1F:
				return AKEY_AT;
			case 0x20:
				return AKEY_HASH;
			case 0x21:
				return AKEY_DOLLAR;
			case 0x22:
				return AKEY_PERCENT;
			case 0x23:
//				return AKEY_CIRCUMFLEX;
				return AKEY_CARET;
			case 0x24:
				return AKEY_AMPERSAND;
			case 0x25:
				return AKEY_ASTERISK;
			case 0x26:
				return AKEY_PARENLEFT;
			case 0x27:
				return AKEY_PARENRIGHT;
			case 0x2B:
				return AKEY_SETTAB;
			case 0x2D:
				return AKEY_UNDERSCORE;
			case 0x2E:
				return AKEY_PLUS;
			case 0x31:
				return AKEY_BAR;
			case 0x33:
				return AKEY_COLON;
			case 0x34:
				return AKEY_DBLQUOTE;
			case 0x36:
				return AKEY_LESS;
			case 0x37:
				return AKEY_GREATER;
			case 0x38:
				return AKEY_QUESTION;
			case 0x3E://Shift+F5
				return AKEY_COLDSTART;
			case 0x43://Shift+F10
				return AKEY_SCREENSHOT_INTERLACE;
			case 0x49://Shift+Insert key
				return AKEY_INSERT_LINE;
			case 0x4C://Shift+Backspace Key
				return AKEY_DELETE_LINE;
			default:
				break;
			}
		}
		if ((key.state == PS2KBD_RAWKEY_DOWN) && !PS2KbdSHIFT && !PS2KbdCONTROL && !PS2KbdALT) {
			switch (key.key) {
			case 0x4:
				return AKEY_a;
			case 0x5:
				return AKEY_b;
			case 0x6:
				return AKEY_c;
			case 0x7:
				return AKEY_d;
			case 0x8:
				return AKEY_e;
			case 0x9:
				return AKEY_f;
			case 0xA:
				return AKEY_g;
			case 0xB:
				return AKEY_h;
			case 0xC:
				return AKEY_i;
			case 0xD:
				return AKEY_j;
			case 0xE:
				return AKEY_k;
			case 0xF:
				return AKEY_l;
			case 0x10:
				return AKEY_m;
			case 0x11:
				return AKEY_n;
			case 0x12:
				return AKEY_o;
			case 0x13:
				return AKEY_p;
			case 0x14:
				return AKEY_q;
			case 0x15:
				return AKEY_r;
			case 0x16:
				return AKEY_s;
			case 0x17:
				return AKEY_t;
			case 0x18:
				return AKEY_u;
			case 0x19:
				return AKEY_v;
			case 0x1A:
				return AKEY_w;
			case 0x1B:
				return AKEY_x;
			case 0x1C:
				return AKEY_y;
			case 0x1D:
				return AKEY_z;
			case 0x49:
				return AKEY_INSERT_CHAR;
			case 0x4C:
				return AKEY_DELETE_CHAR;
			default:
				break;
			}
		}
		if ((key.state == PS2KBD_RAWKEY_DOWN) && PS2KbdCONTROL && !PS2KbdALT) {
			switch(key.key) {
			case 0x4:
				return AKEY_CTRL_a;
			case 0x5:
				return AKEY_CTRL_b;
			case 0x6:
				return AKEY_CTRL_c;
			case 0x7:
				return AKEY_CTRL_d;
			case 0x8:
				return AKEY_CTRL_e;
			case 0x9:
				return AKEY_CTRL_f;
			case 0xA:
				return AKEY_CTRL_g;
			case 0xB:
				return AKEY_CTRL_h;
			case 0xC:
				return AKEY_CTRL_i;
			case 0xD:
				return AKEY_CTRL_j;
			case 0xE:
				return AKEY_CTRL_k;
			case 0xF:
				return AKEY_CTRL_l;
			case 0x10:
				return AKEY_CTRL_m;
			case 0x11:
				return AKEY_CTRL_n;
			case 0x12:
				return AKEY_CTRL_o;
			case 0x13:
				return AKEY_CTRL_p;
			case 0x14:
				return AKEY_CTRL_q;
			case 0x15:
				return AKEY_CTRL_r;
			case 0x16:
				return AKEY_CTRL_s;
			case 0x17:
				return AKEY_CTRL_t;
			case 0x18:
				return AKEY_CTRL_u;
			case 0x19:
				return AKEY_CTRL_v;
			case 0x1A:
				return AKEY_CTRL_w;
			case 0x1B:
				return AKEY_CTRL_x;
			case 0x1C:
				return AKEY_CTRL_y;
			case 0x1D:
				return AKEY_CTRL_z;
			case 0x1E:
				return AKEY_CTRL_1;
			case 0x1F:
				return AKEY_CTRL_2;
			case 0x20:
				return AKEY_CTRL_3;
			case 0x21:
				return AKEY_CTRL_4;
			case 0x22:
				return AKEY_CTRL_5;
			case 0x23:
				return AKEY_CTRL_6;
			case 0x24:
				return AKEY_CTRL_7;
			case 0x25:
				return AKEY_CTRL_8;
			case 0x26:
				return AKEY_CTRL_9;
			case 0x27:
				return AKEY_CTRL_0;
			case 0x2B:
				return AKEY_CLRTAB;
			case 0x33:
				return AKEY_SEMICOLON | AKEY_CTRL;
			case 0x36:
				return AKEY_LESS | AKEY_CTRL;
			case 0x37:
				return AKEY_GREATER | AKEY_CTRL;
			default:
				break;
			}
		}
		if ((key.state == PS2KBD_RAWKEY_DOWN) && PS2KbdALT) {
			switch(key.key) {
			//case dcr ylsa
			case 0x7:
				UI_alt_function = UI_MENU_DISK;
				return AKEY_UI;
			case 0x6:
				UI_alt_function = UI_MENU_CARTRIDGE;
				return AKEY_UI;
			case 0x15:
				UI_alt_function = UI_MENU_RUN;
				return AKEY_UI;
			case 0x1C:
				UI_alt_function = UI_MENU_SYSTEM;
				return AKEY_UI;
			case 0xF:
				UI_alt_function = UI_MENU_LOADSTATE;
				return AKEY_UI;
			case 0x16:
				UI_alt_function = UI_MENU_SAVESTATE;
				return AKEY_UI;
			case 0x17:
				UI_alt_function = UI_MENU_CASSETTE;
				return AKEY_UI;
			case 0x4:
				UI_alt_function = UI_MENU_ABOUT;
				return AKEY_UI;
			default:
				break;
			}
		}


		if (key.state == PS2KBD_RAWKEY_UP) {
			switch (key.key) {
			case 0x39:

			return AKEY_CAPSTOGGLE;
			case 0xE0:
				PS2KbdCONTROL = 0;
				return AKEY_NONE;
			case 0xE4:
				PS2KbdCONTROL = 0;
				return AKEY_NONE;
			case 0xE1:
				PS2KbdSHIFT = 0;
				return AKEY_NONE;
			case 0xE2:
				PS2KbdALT = 0;
				return AKEY_NONE;
			case 0xE5:
				PS2KbdSHIFT = 0;
				return AKEY_NONE;
			case 0xE6:
				PS2KbdALT = 0;
				return AKEY_NONE;
			default:
				break;
			}
		}
	}
}
	return AKEY_NONE;
}