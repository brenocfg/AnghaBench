#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_7__   TYPE_2__ ;
typedef  struct TYPE_6__   TYPE_1__ ;

/* Type definitions */
struct TYPE_7__ {int bmRequestType; int bRequest; int wValue; int wIndex; char const* pData; scalar_t__ wLenDone; int /*<<< orphan*/  wLength; } ;
struct TYPE_6__ {scalar_t__ (* DeviceRequest ) (TYPE_1__**,TYPE_2__*) ;} ;
typedef  TYPE_1__ IOUSBDeviceInterface ;
typedef  TYPE_2__ IOUSBDevRequest ;
typedef  scalar_t__ IOReturn ;

/* Variables and functions */
 int KERN_FAILURE ; 
 scalar_t__ KERN_SUCCESS ; 
 char* defaultMsg ; 
 int /*<<< orphan*/  printf (char*) ; 
 int /*<<< orphan*/  strlen (char const*) ; 
 scalar_t__ stub1 (TYPE_1__**,TYPE_2__*) ; 

__attribute__((used)) static int send_usb_msg(IOUSBDeviceInterface** dev, int type, int reqno, int val, int idx,  const char *msg)
{
    
    if(!dev){
        printf("No device handle given.\n");
        return KERN_FAILURE;
    }
	
    if(!msg)
        msg = defaultMsg;
    
    IOUSBDevRequest req;
    req.bmRequestType = type;
    req.bRequest = reqno;
    req.wValue = val;
    req.wIndex = idx;
    req.wLength = strlen(msg);
    req.pData =  msg;
    req.wLenDone = 0;
    IOReturn rc = KERN_SUCCESS;
    
    rc = (*dev)->DeviceRequest(dev, &req);
    
    if(rc != KERN_SUCCESS)
    {
        return rc;
    }
    
    return KERN_SUCCESS;
}