#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_3__   TYPE_1__ ;

/* Type definitions */
struct TYPE_3__ {int entry_number; int base_addr; int limit; int seg_32bit; int seg_not_present; scalar_t__ lm; scalar_t__ useable; scalar_t__ limit_in_pages; scalar_t__ read_exec_only; int /*<<< orphan*/  contents; } ;

/* Variables and functions */
 int FLAG ; 
 int /*<<< orphan*/  MODIFY_LDT_CONTENTS_STACK ; 
 int /*<<< orphan*/  add_ldt (TYPE_1__*,char*) ; 
 TYPE_1__ new_stack_segment ; 
 int /*<<< orphan*/  sleep (int) ; 

void * segManipulatorThread(void * none)
{
  new_stack_segment.entry_number    = 0x12;
  new_stack_segment.base_addr       = 0x10000;
  new_stack_segment.limit           = 0xffff;
  new_stack_segment.seg_32bit       = 1;
  new_stack_segment.contents        = MODIFY_LDT_CONTENTS_STACK; /* Data, grow-up */
  new_stack_segment.read_exec_only  = 0;
  new_stack_segment.limit_in_pages  = 0;
  new_stack_segment.seg_not_present = 0;
  new_stack_segment.useable         = 0;
  new_stack_segment.lm = 0;
  
  // Create a new stack segment
  add_ldt(&new_stack_segment, "newSS");
  
  // Wait for main thread to use new stack segment
  sleep(3);  

  // Invalidate stack segment 
  new_stack_segment.seg_not_present = 1;
  add_ldt(&new_stack_segment, "newSS disable");
  FLAG = 1;
  sleep(15);
  
  return NULL;
}